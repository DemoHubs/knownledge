# 面经





## 2020年 03月29号 阿里

### 一面

- 1、支付系统业务上的思考
- 2、根据什么指标，怎么设计的系统
  - 支付系统的指标其实就是自己给的一个估算，然后整个系统支持横向扩展，如果系统撑不住了，那么可以通过增加业务机器的数量来保证系统可用
- 3、怎么处理红包缓存和数据库一致性的问题
- 4、怎么处理缓存故障
- 5、聊聊垃圾回收
- 6、红包接入层、红包业务层怎么支持高并发
- 7、支付系统的业绩，我说了扫码收款，单月1400万(支付系统基本上整个都是我设计和开发的)
- 8、RocketMQ为什么能起到削峰填谷的作用?







## 2020年 03月20号 阿里

### 一面

1. 怎么判断一个链表上面是否有环
   1. 解法一：每个节点增加一个标志位字段，如果遍历过这个节点，则标志位设置为true。如果一个节点的next节点为true，则表示有环。
   2. 解法二：设置两个指针，开始都指向链表头，然后其中一个指针每次向前走一步，另一个指针每次向前走两步，如果快的遇到NULL了，证明该链表中没有环，如果有环，快的指针每次都要比慢的多走一步，最终两个指针会相遇。时间复杂度为O(n)。
2. 怎么快速求出链表的长度
   1. 使用一个字段记录元素个数，需要获取链表长度的时候，直接返回这个元素的个数。
   2. 在插入的时候字段值加1，在删除元素的时候字段值减1
3. HashMap
   1. 原理
   2. 平时工作上面的使用场景
      1. 读取一个json字符串，然后转换成Map，然后获取其中的值
      2. 数据库字段存储json格式的字符串，就先把字段值传递到map中，然后把map转换为json字符串
   3. 为什么使用红黑树，而不是使用其他的数据结构
4. ArrayList、LinkedList
   1. 原理
   2. 使用场景
      1. 对于查询比较多的场景，就使用ArrayList
      2. 对于新增、删除比较多的场景，就使用LinkedList
5. 一张表上面有200w条数据，怎么做分页查询
   1. 我的回答是通过“延迟关联”，是满足条件的，如果数据更大，就考虑用分表
   2. 辅助索引、覆盖索引的区别







## 2020年 02月11号 阿里

### 一面

- 1、一致性hash算法
- 2、支付系统架构
- 3、灰度系统架构



### 二面（主管，可能是最难的一次面试了）

- 1、哈夫曼编码原理，用来做什么的
  - 参考：”算法——》数据结构——》哈夫曼树“
- 2、对于数据库的热点数据行，可能有很多请求同时到达数据库了，然后对这个数据进行更新，业内通用的设计方案是什么？
  - 业务场景：有一款秒杀系统，某个商品的库存是10，很多用户同时进行秒杀，会去更新”库存”这个数字，不能使用分布式锁，怎么保证更新正确？
  - 参考：“项目——》热点数据更新问题”
- 3、假如让你设计一款秒杀系统，怎么设计
  - 参考：“项目——》系统设计与经验——》秒杀系统”
- 4、protocol buffer动态码流的具体是怎么做到的？（问这个算法是怎么实现的）
  - 参考：”框架——》序列化——》protocol buffer“
- 5、redis和Zookeeper作为分布式锁的区别，什么情况下使用redis，什么情况下使用Zookeeper会比较好
- 6、**具体说说不加分布式锁可能有并发问题的情况？怎么解决这些情况？**（重点解决啊，当时卡了很久。。）
  - 处理一个业务请求有3步，读取数据、修改数据、更新数据，举出具体的业务场景
  - 比如说公有账户的充值，咱们支付系统有一个公有账户（企业红包），如果有2个用户对这个公有账户进行充值，并且系统没有进行并发控制，则可能出现如下情况：
    - 公有账户本来有金额100元
    - 用户A读取公有账户的余额是100元，进行充值，在100的基础上面加50
    - 用户B读取公有账户的余额是50元，进行充值，在100的基础上面加30
    - 由于用户B晚于用户A，最终公有账户的余额变成130。正常应该是180
  - 也就是说，存在丢失更新的问题
  - 针对这种情况，需要使用分布式锁进行并发控制，先获取分布式锁再进行资金处理，处理完之后释放分布式锁，让请求串行化执行。
- 7、直接内存dirctBuffer有什么特性，可以用来做什么？
  - 参考：”java——》jvm——》jvm“
- 8、线程池有哪些配置参数，设置线程池的线程数量的时候，通用规则是什么？（根据IO密集型、CPU密集型）
  - 参考：“java——》并发——》线程池”
- 9、Zookeeper为什么有原子性，Zookeeper实现分布式锁的原理
- 10、springmvc中bean的生命周期
- 11、MVCC的原理； 快照读、当前读有什么不同？
  - 参考：“MySQL——》锁”
- 12、redis支持持久化吗？有哪些持久化方式，这些持久化方式有什么不用？ AOF的方式支持绝对安全吗？











## 2019年 12月26号 阿里

### 一面

- 1、 支付平台回调的高可用保证
  - 见“项目——》支付——》支付系统”
- 2、红包生成金额的算法
  - 见“项目——》支付——》支付系统——》红包”
- 3、10个redis节点组成的集群，分摊所有key，这时候客户访问的key在所有的节点挂了，怎么保证高可用
  - 每个节点再组成主从集群
- 4、资金真的出问题了，怎么补偿
  - 内部资金错误，采用调账
  - 外部资金错乱，比如说提现金额错误，这就主要是预防，人工审核大金额的提现
- 5、如何处理幂等
- 6、支付系统是分布式的，怎么保证数据的一致性？
  - 重试、补偿、回滚、日志备份、监控、调账
- 7、灰度系统 mq灰度的实现，怎么保证灰度机器发送的mq消息被灰度机器消费
  - 灰度环境采用灰度的topic，正式环境采用正式的topic
- 8、redis集群（codis）
- 9、java控制并发，如synchronized、ReentrankLock，他们的原理



### 二面（主管）

- 1、top的load指标
- 2、研发生命周期(没能理解他说啥)
  - 应该是软件生命周期吧，参考：[https://baike.baidu.com/item/%E8%BD%AF%E4%BB%B6%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/861455?fr=aladdin](https://baike.baidu.com/item/软件生命周期/861455?fr=aladdin)
  - 需求分析阶段——》软件设计阶段——》软件测试阶段——软件运行和维护阶段
- 3、浏览器输入地址，会经过哪些步骤
- 4、项目亮点
- 5、业余学习哪些书籍(这个说的太少了)
- 6、NIO、BIO的区别，NIO相对于BIO的优点
- 7、查找某个端口被什么应用占用着
- 8、慢sql怎么优化



### 三面（BOSS面）

- 1、怎么学习一门新技术，学过哪些比较新的技术
- 2、k8s原理
- 3、怎么做code review
- 4、单元测试技术，用过哪些(jmockit)
- 5、灰度系统(下次要主动说明从web层开始路由)
- 6、支付系统要点
- 7、为什么会考上这个学校
- 8、单元测试怎么保证每一个路径都覆盖到呢？
- 9、不同的部门，有针对的准备吧



### 四面（hr）

- TCP和UDP的区别，tcp、udp的端口分别是什么
  - 这里被套路了，TCP和UDP的端口是程序里面绑定的，不是写死的。hr随便问，自己也没有被问过这种问题，一下子懵了，我啊，为何不会自己主动思考一下。。。。。
- 愿不愿意加班
- 吉林大学珠海学院是民办还是公办（民办）
- 做过最有难度的系统是什么，为什么交给你做
- 支付系统的用户量是多少
  - 支付系统的用户量为300w。这里就牵扯到**根据哪些指标去设计一个系统的问题**
  - **当时特别的奇怪，hr听成了8个，我居然没有去纠正。我自己一时也忘记了具体是多少个，所有懵了。其实这种问题非常关键，关系到系统的价值。一定一定要想清楚再说啊。**
- 支付系统、灰度系统为什么不交给别人做，交给你做？
- 先说结论吧：**这次失败的主要原因，是因为对hr的问题没有经过思考，就说出来。并且hr有误解的地方，没有从源头开始纠正。 另外，视频面试的时候，看着别人讲话，不要去注意别人的表情，要咬文嚼字，理清楚别人的意思啊**
- 下次面试的时候，绝对不要跟任何人说了。。。。
- **另外还有hr口中失败的原因，等待他的回复**
- 以后绝对不LG了，严重影响智力和记忆力。**如果要成功，就把LG给戒了！！！**









## 2019年 12月15号 阿里

### 一面

- 1、为什么hashmap不用AVL树，用红黑树
  - 见“jdk源码——》集合——》hashMap”
- 2、怎么找到链表的倒数第n个节点。如果有环，怎么办？
  - 见“算法——》LeetCode——》基础算法题”
- 3、int a=300;  integer b=300，使用等号是true还是false;     integer a=300，b=300呢？     integer a=3, b=3呢？
  - true 、 false、  true
- 4、hashMap1.8相对于1.7做了哪些改进
  - 见“jdk源码——》集合——》hashMap”
- 5、排查线上问题，比如说cpu打满了，怎么排查？
  - 见“项目——》线上问题排查”
- 6、老年代都是什么对象
  - 见“java——》jvm——》GC垃圾回收”
- 7、new一个hashMap，初始容量为1000，然后插入1000个元素，会不会触发扩容。如果是10000呢？
  - 见“jdk源码——》集合——》hashMap”
- 8、其他，比如红包项目、Dubbo、Redis答得还行















## 2019年11月 阿里



### 一面

- 1、java基础类型：byte、char、boolean、short、int、long、float、double
- 2、java是值传递还是引用传递
- 3、一个char多少字节
- 4、ip的网络拓扑
  - 有很多网络，通过路由器连接起来。当源主机发送HTTP报文给目标主机，源主机的路由器获得HTTP报文中的目标主机的IP地址，然后判断该IP地址所处的网络是否和路由器直接相连，如果是，则直接交付给文。否则，把HTTP报文转交给下一个路由器。
- 5、tcp怎么把数据传递给ip
  - 加上IP首部，比如说源主机IP地址、目标主机IP地址
- 6、场景题：双11接近12点的时候，jvm的内存逐渐升高，只有发生full gc，内存才降下来，什么原因
  - 我的思路是：接近12点的时候，请求越来越多，每次请求都可能创建一些对象，并且请求还没有结束，这些对象被引用着，随着占用内存升高，开始频繁发生minor gc，由于请求量很大，很多请求也还没结束，这些临时对象还被引用着，因此无法回收。
    当minor gc达到一定次数，这些临时对象还晋升到老年代了。当老年待内存不够，发生分配担保失败，引发了full gc，由于这时之前的很多请求结束了，因此很多临时对象没有被引用了，从而被回收了，内存又被释放出来。
- 7、findClass和loadClass的区别
  - findClass在ClassLoader中是父类找不到，然后去子类中查找，如果只重写findClass方法，实际上还是会走双亲委派模型
  - loadClass在ClassLoader中是先去父类中找类，找不到再调用findClass去找。因此如果想破坏双亲委派模型，重写loadClass方法才行。（当然，还可以利用线程上下文类加载器等方法）
- 8、桶令牌算法的实现限流
- 9、如果抢红包的时候，缓存中的红包数据没有了，怎么办？
- 10、哪些对象可以称为GC Root
- 11、类对象的回收条件
- 12、Integer的缓存范围
- 13、自己实现客户端来使用Cookie
- 14、支付平台回调过程中有哪些参数？





### 二面

- 1、CMS收集器
  - （1）执行流程：初始标记、并发标记、重新标记、并发清除
- 2、一个集群有好几个redis节点，同时收到hsetnx请求，那么会不会发生这样的情况：几个redis节点同时判断key没有，然后就插入。(答案在项目解析里)
- 3、红包里面，1个人同时点了很多下抢红包，产生2个请求，一个请求来到服务A，一个请求来到服务B，那么怎么保证这个人不会抢到2个红包？（如何保证一个人不会抢到多个红包） (答案在项目解析里)
- 4、多个人同时抢，如何保证不会抢到同一个红包？(答案在项目解析里)
- 5、dubbo消费调用过程
- 6、设计原则（只说了一点，要加强）、设计模式（整理一下咱们项目中使用到的所有设计模式）
- 7、MySQL的索引实现
  - （1）有哪些索引，这里说的不够全： 聚集索引、联合索引、唯一索引、覆盖索引
- 8、RocketMQ是顺序消费的吗？如何实现顺序消费？顺序消费有什么坏处？
- 9、假设要重启一个dubbo服务，怎么切掉流量重启，然后重启完了再切回流量
  - 参考   Dubbo优雅停机——》问题





### 三面（主管）

- 1、如果hsetnx实际上是成功的，但是redis返回超时，这种情况怎么处理

- 2、算法：（1）堆排序的实现、时间复杂度    （2）快速排序的实现、时间复杂度

​                     （3）走阶梯问题，如果一次可以走1步或者2步，一共有多少种走法？

​				参考：https://blog.csdn.net/sinat_25972161/article/details/72456518

- 3、如何实现一个自定义同步器
- 4、如何保证高并发
- 5、峰值QPS、一天的流量PV
- 6、什么是高并发、高流量？
  - 高并发指的是流量很大的情况下，系统还能正常运行，并且保证数据不出错
  - 高流量指的是请求量很大





### 四面（BOSS面）

- 1、Dubbo整体架构，分为几层
- 2、Dubbo默认使用什么解析协议，还知道哪些协议
- 3、Zookeeper是什么协议实现的，为什么不直接使用Paxos协议
- 4、Synchronize为什么使用自旋锁
- 5、自旋锁适用于什么场景
- 6、Java有哪几种锁（乐观锁、悲观锁）
- 7、Java值传递、引用传递
- 8、形参、实参是什么，有什么区别
- 9、灰度系统的实现
- 10、支付系统的实现，怎么抗住高并发
- 11、Dubbo网络调用过程（其实就是消费过程）

















## 扩展



1、**分布式相关的，比如Spring、Dubbo、ZK、Redis、DB、MQ这些重点准备**

2、做过的项目挑出来讲的，要了解整个项目的价值、和发展方向